import{j as e,i as R,t as M,u as B,A as L,v as F,e as p}from"./ui-vendor-BkC7JKse.js";import{u as H,r as f}from"./react-vendor-Bxu37LRh.js";import{u as O,B as U,C as o,a as i,b as c,e as l,d as z}from"./auth-O_ZHyfl3.js";import{B as I}from"./badge-CCDgyR52.js";import{s as b}from"./services-DUvvMEkv.js";import"./utils-vendor-BPxHO2rW.js";import"./supabase-vendor-2z3JYExL.js";function V(){const{user:x}=O(),S=H(),[u,k]=f.useState([]),[C,N]=f.useState(!0),[d,T]=f.useState({totalSessions:0,currentStreak:0,bestStreak:0,averagePerWeek:0,completionRate:0,favoriteDay:"",favoriteTime:""});f.useEffect(()=>{if(!x)return;(async()=>{try{N(!0);const r=await b.getUserSessions(x.id);k(r);const n=r.filter(t=>t.status==="completed"),m=n.length,w=r.filter(t=>t.status!=="cancelled").length,v=await b.calculateStreak(x.id),h=new Set;n.forEach(t=>{const a=A(t.date);h.add(a)});const E=h.size>0?(m/h.size).toFixed(1):"0",j={};n.forEach(t=>{const a=t.date.toLocaleDateString("en-US",{weekday:"long"});j[a]=(j[a]||0)+1});const W=Object.entries(j).sort((t,a)=>a[1]-t[1])[0]?.[0]||"N/A",g={};n.forEach(t=>{const a=D(t.startTime);g[a]=(g[a]||0)+1});const P=Object.entries(g).sort((t,a)=>a[1]-t[1])[0]?.[0]||"N/A";T({totalSessions:m,currentStreak:v,bestStreak:v,averagePerWeek:parseFloat(E),completionRate:w>0?Math.round(m/w*100):0,favoriteDay:W,favoriteTime:P})}catch(r){console.error("Error loading analytics:",r)}finally{N(!1)}})()},[x]);const A=s=>{const r=new Date(s),n=r.getDay(),m=r.getDate()-n+(n===0?-6:1);return r.setDate(m),r.toISOString().split("T")[0]},D=s=>s<6?"Early Morning":s<12?"Morning":s<17?"Afternoon":s<21?"Evening":"Night",y=s=>{const r=s>=12?"PM":"AM";return`${s===0?12:s>12?s-12:s}:00 ${r}`};return C?e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary mx-auto"}),e.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading analytics..."})]})}):e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(U,{variant:"ghost",onClick:()=>S("/dashboard"),className:"mb-4",children:[e.jsx(R,{className:"mr-2 h-4 w-4"}),"Back to Dashboard"]}),e.jsx("h1",{className:"text-3xl font-bold",children:"Workout Analytics"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Track your progress and see your workout patterns"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Total Workouts"}),e.jsx(M,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.totalSessions}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sessions completed"})]})]}),e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Current Streak"}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["ðŸ”¥ ",d.currentStreak]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Consecutive weeks"})]})]}),e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Completion Rate"}),e.jsx(L,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[d.completionRate,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Of scheduled sessions"})]})]}),e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Average Per Week"}),e.jsx(F,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.averagePerWeek}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Sessions per week"})]})]}),e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Favorite Day"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.favoriteDay}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Most workouts"})]})]}),e.jsxs(o,{children:[e.jsxs(i,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(c,{className:"text-sm font-medium",children:"Favorite Time"}),e.jsx(p,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(l,{children:[e.jsx("div",{className:"text-2xl font-bold",children:d.favoriteTime}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Preferred workout time"})]})]})]}),e.jsxs(o,{children:[e.jsxs(i,{children:[e.jsx(c,{children:"Session History"}),e.jsx(z,{children:"Your recent workout sessions"})]}),e.jsx(l,{children:u.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No sessions yet. Start scheduling workouts to see your history!"}):e.jsxs("div",{className:"space-y-4",children:[u.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{className:"h-4 w-4 text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.date.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"})}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[y(s.startTime)," - ",y(s.endTime)]})]})]}),e.jsx(I,{variant:s.status==="completed"?"default":s.status==="confirmed"?"secondary":"outline",children:s.status})]},s.id)),u.length>10&&e.jsxs("p",{className:"text-center text-sm text-muted-foreground pt-2",children:["Showing 10 of ",u.length," sessions"]})]})})]})]})}export{V as Analytics};
